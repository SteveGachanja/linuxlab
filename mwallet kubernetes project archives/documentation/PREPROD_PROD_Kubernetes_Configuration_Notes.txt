## PREPROD KUBERNETES LOG PATH CONFIGURATION
=========================================================

1. Log into the KUBERNETES PREPROD 	- ssh appadmin@172.16.20.55

2. Create the logs path /home/appadmin/mwallet-logs

3. sudo vim /etc/exports

4. Add the Mwallet Storage Path with the following line items <change IPs to represent the environment >
   /home/appadmin/mwallet-logs 172.16.20.56(no_root_squash,rw,sync)
   /home/appadmin/mwallet-logs 172.16.20.57(no_root_squash,rw,sync)

5. sudo exportfs -a

6. Apply the deployment mwallet-logs.yml

7. Apply the deployment secrets.yml

8. Apply the deployment mwallet-backend.yml


## NGINX CONFIGURATION

1. DEPLOY
kubectl delete -f nginx-deploy.yaml
kubectl apply -f nginx-deploy.yaml
image SVSACCODOCKER.CO-OPBANK.CO.KE:5000/omniadmin/nginxproxy:build_by_sngachanja_v1.301

2. Change External IP
Change externalIPs on nginx-deploy.yaml service yaml IPs to represent the PRODUCTION NGINX IPs
Example below is pointing to DEVELOPMENT
externalIPs:
    - 172.16.20.39

2. REGENERATE CERT PROCESS

STEP 1  - generate certificate
sudo openssl req  -nodes -new -x509  -keyout server.key -out server.cert

STEP 2 - Rebuild the NGINX Image/ Note version and time
sudo docker build -t SVSACCODOCKER.CO-OPBANK.CO.KE:5000/omniadmin/nginxproxy:build_by_sngachanja_v1.301 .

STEP 3 - Push the new Image
sudo docker push SVSACCODOCKER.CO-OPBANK.CO.KE:5000/omniadmin/nginxproxy:build_by_sngachanja_v1.301

STEP 4 - Change External IP
Change externalIPs on nginx-deploy.yaml service yaml IPs to represent the PRODUCTION NGINX IPs
Example below is pointing to DEVELOPMENT
externalIPs:
    - 172.16.20.39
	
STEP 5 - DEPLOY
kubectl delete -f nginx-deploy.yaml
kubectl apply -f nginx-deploy.yaml
image SVSACCODOCKER.CO-OPBANK.CO.KE:5000/omniadmin/nginxproxy:build_by_sngachanja_v1.301	
	
   
## KUBECTL BASIC COMMANDS
========================================================
/app/appadmin/jenkins/workspace/M-Wallet-Project/Deploy-Mwallet-Dev	  # DEV path
/app/appadmin/jenkins/workspace/M-Wallet-Project/Deploy-Mwallet-UAT	  # UAT path

kubectl get pods -o wide						                      # Get information which pods on which nodes
kubectl get svc                                                       # Get routing info
kubectl get pv                                                        # Get Persistence volumes info
kubectl scale --replicas=3 -f mwalletdeploy-backend.yaml		      # Scale mwaller resources specified in mwalletdeploy-backend.yaml to 3
kubectl logs <specify pod>                                            # Get logs

https://kubernetes.io/docs/reference/kubectl/cheatsheet/              #Kubernetes Cheat sheet
